# Created on 2022-12-12 by converting .gitlab-ci.yaml with gh actions-importer
# gh version 2.20.2, actions-importer v1.0.1, actions-importer/cli v1.0.14577

name: nfdi4cat/ta1-ontologies/voc4cat-tool
on:
  push:
  pull_request:
  workflow_dispatch:
concurrency:
  group: "${{ github.ref }}"
  cancel-in-progress: true
env:
  PROJECT_ACCESS_TOKEN: "${{ secrets.PROJECT_ACCESS_TOKEN }}"
jobs:
  tests:
    runs-on: ubuntu-latest
    container:
      image: python:3.10-bullseye
    timeout-minutes: 60
    env:
      PIP_CACHE_DIR: "${{ github.workspace }}/.cache/pip"
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 50
        lfs: true
    - uses: actions/cache@v3
      with:
        path: |-
          .cache/pip
          .venv/
        key: default
    - run: python --version
    - run: python -m venv .venv
    - run: source .venv/bin/activate
    - run: python -m pip install -U pip
    - run: pip install -U .[tests]
    - run: pytest
  coverage:
    needs: tests
    runs-on: ubuntu-latest
    container:
      image: python:3.10-bullseye
    timeout-minutes: 60
    env:
      PIP_CACHE_DIR: "${{ github.workspace }}/.cache/pip"
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 50
        lfs: true
    - uses: actions/cache@v3
      with:
        path: |-
          .cache/pip
          .venv/
        key: default
    - run: python --version
    - run: python -m venv .venv
    - run: source .venv/bin/activate
    - run: python -m pip install -U pip
    - run: pip install -e .[tests]
    - run: pytest -q --cov=src tests
    - run: coverage xml
#     # 'artifacts.coverage_report' was not transformed because there is no suitable equivalent in GitHub Actions
#     # 'coverage' was not transformed because there is no suitable equivalent in GitHub Actions.
